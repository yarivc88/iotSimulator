package simulator;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.ArrayList;


import io.netty.buffer.ByteBuf;
import io.netty.buffer.Unpooled;

public class Test {
	private static final Byte SUCCESS_MASSAGE = 0001;
	private static final Byte FAILED_MASSAGE = 0000;

	public static void main(String[] args) throws UnknownHostException, IOException {
		Test ta = new Test();
		System.out.println(Thread.currentThread().getName());

		ArrayList<Thread> list = new ArrayList<Thread>();
		for (int i = 0; i < 1; i++) {

			Thread d = new Thread("" + i) {
				@Override
				public void run() {
					System.out.println("Thread: " + getName() + " running");
					try {
						try {

							ta.run();
						} catch (InterruptedException e) {
							// TODO Auto-generated catch block
							e.printStackTrace();
						}
					} catch (IOException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
			};
			list.add(d);

		}
		list.parallelStream().forEach(t -> {
			try {
				t.sleep(500);
				t.start();
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}

		});

	}

	public void run() throws UnknownHostException, IOException, InterruptedException {
		// fmb630
		// ByteBuf id = binary("000f3335363330373034323434313031344512");
		// ByteBuf data = binary(
		// "0000000000000401080e0000015d12cc211000fadaf627186742f5000d0048080006000a040100f001500515000342318a430fe344000003c700000000f1000068b61000001b05000000015d12c6683800fadaf72118673f82000000000000000007030100f00050040342318a430fe344000001f1000068b6000000015d12bd407800fadaf72118673f82000000000000000007030100f000500403423179430fe144000001f1000068b6000000015d12b414d000fadaf72118673f82000400900c0000fa120a0100f00050051502080007010552090e6f4bfa000542316a430fe14400000600006202b203c700002328f1000068b61000001b05000000015d12b3074800fadaf2821867436a000400890d00170011090100f00150011502081007010553090e6f4d054231fb430fe14400000603ae6202a003c700002328f1000068b61000001b05000000015d12b2ff7800fadaee89186747c60005009a0d001d0011090100f00150011502081b07010553090e6f4d05423125430fe144000006050862029e03c700002328f1000068b61000001b05000000015d12b2e42000fadae8cf18675e0a000300a60d00210011090101f00150011502082407030554090e6f4d0542310a430fe14400000606cf62029703c700002328f1000068b61000001b05000000015d12b2d48000fadae05818676a16000400930c00240011090100f00150011502082207010554090e6f4e05423738430fe144000006066a62029303c700002328f1000068b61000001b05000000015d12b2a1b800fadac33e18678e48000600940d00150011090101f00150051500081907030553090e6f4e054239cc430fe14400000607c662028603c700002328f1000000001000001b05000000015d12b29dd000fadac19d18678fc8000700820d00110011090100f00150051500081607030553090e6f4e054238c8430fe14400000606d962028503c700002328f1000000001000001b05000000015d12b299e800fadabfa9186790e3000700670d00110011090101f00150051500081407030553090e6f4e054231e5430fe144000006060a62028403c700002328f1000000001000001b05000000015d12b2960000fadabd4018679104000600510d00120011090101f00150051500081207030553090e6f4e054231ce430fe144000006057062028303c700002328f1000000001000001b05000000015d12b27aa800fadaa96518678b7c000600470d00120011090101f00150051500081807030551090e6f4e05423a70430fe144000006074462027c03c700002328f1000000001000001b05000000015d12b276c000fadaa73f18678ae60006003b0d000e0011090101f00150051500081607030551090e6f4e05423a5a430fe14400000606b762027b03c700002328f1000000001000001b05000e000007a4");
		ByteBuf data = binary(
				"007200031723b3d67ba54400015f57521c000000c981e5a208aa88980fa872ce0a00270b00090c000501001b1600b027005800000200000300001c0100201e00ad0101a20101950101960104001d359c001e0ffb0016004800170042020041026cf81000960001130201002200000000000000002d1d");

		//
		ByteBuf id = binary("000f333532303934303833373936383739");
		ByteBuf command = binary("00000000000000100c010600000008234552524f520d0a0100007567");
		// ByteBuf data = binary(
		// "00af00031723b3d52c7d4400025f08bd21001000c9b80de4088d6c0e0ded6af40b00000800070e000501001b12019f0001a201000200000300001c0100202300ad0000860000820000860000870000880007001d3361001e0fe50016004d00170048008300000089001e008b001e04004100b4b4d0009600011302002f00000000024300000000005f08bd21001100c9b80de4088d6c0e0ded6af40b000008000700000200300000001d0244008926c00047d7");

		// fmb630
		// ByteBuf id = binary("000f3335363330373034323434313031344512");
		// ByteBuf data = binary(
		// "0000000000000401080e0000015d12cc211000fadaf627186742f5000d0048080006000a040100f001500515000342318a430fe344000003c700000000f1000068b61000001b05000000015d12c6683800fadaf72118673f82000000000000000007030100f00050040342318a430fe344000001f1000068b6000000015d12bd407800fadaf72118673f82000000000000000007030100f000500403423179430fe144000001f1000068b6000000015d12b414d000fadaf72118673f82000400900c0000fa120a0100f00050051502080007010552090e6f4bfa000542316a430fe14400000600006202b203c700002328f1000068b61000001b05000000015d12b3074800fadaf2821867436a000400890d00170011090100f00150011502081007010553090e6f4d054231fb430fe14400000603ae6202a003c700002328f1000068b61000001b05000000015d12b2ff7800fadaee89186747c60005009a0d001d0011090100f00150011502081b07010553090e6f4d05423125430fe144000006050862029e03c700002328f1000068b61000001b05000000015d12b2e42000fadae8cf18675e0a000300a60d00210011090101f00150011502082407030554090e6f4d0542310a430fe14400000606cf62029703c700002328f1000068b61000001b05000000015d12b2d48000fadae05818676a16000400930c00240011090100f00150011502082207010554090e6f4e05423738430fe144000006066a62029303c700002328f1000068b61000001b05000000015d12b2a1b800fadac33e18678e48000600940d00150011090101f00150051500081907030553090e6f4e054239cc430fe14400000607c662028603c700002328f1000000001000001b05000000015d12b29dd000fadac19d18678fc8000700820d00110011090100f00150051500081607030553090e6f4e054238c8430fe14400000606d962028503c700002328f1000000001000001b05000000015d12b299e800fadabfa9186790e3000700670d00110011090101f00150051500081407030553090e6f4e054231e5430fe144000006060a62028403c700002328f1000000001000001b05000000015d12b2960000fadabd4018679104000600510d00120011090101f00150051500081207030553090e6f4e054231ce430fe144000006057062028303c700002328f1000000001000001b05000000015d12b27aa800fadaa96518678b7c000600470d00120011090101f00150051500081807030551090e6f4e05423a70430fe144000006074462027c03c700002328f1000000001000001b05000000015d12b276c000fadaa73f18678ae60006003b0d000e0011090101f00150051500081607030551090e6f4e05423a5a430fe14400000606b762027b03c700002328f1000000001000001b05000e000007a4");
		Socket clientSocket = new Socket("10.0.0.7", 7071);
		// Socket clientSocket = new Socket("localhost", 7071);
		// System.out.println(data.array().length);
		clientSocket.setSendBufferSize(10000);
		DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
		DataInputStream inFromServer = new DataInputStream(clientSocket.getInputStream());
		outToServer.write(command.array());
//		while (true) {
//			if (clientSocket.isClosed()) {
//				clientSocket = new Socket("10.0.0.7", 11704);
//				clientSocket.setSendBufferSize(10000);
//				outToServer = new DataOutputStream(clientSocket.getOutputStream());
//				inFromServer = new DataInputStream(clientSocket.getInputStream());
//			}
//
//			outToServer.write(data.array());
//			// outToServer.flush();
//			inFromServer.readUTF();
//			System.out.println("running... " + Thread.currentThread().getName());
//
//			clientSocket.close();
//			Thread.currentThread().sleep(3000);
//		}
	}

	public ByteBuf binary(String... data) {
		return Unpooled.wrappedBuffer(DataConverter.parseHex(concatenateStrings(data)));
	}

	private String concatenateStrings(String... strings) {
		StringBuilder builder = new StringBuilder();
		for (String s : strings) {
			builder.append(s);
		}
		return builder.toString();
	}
}
